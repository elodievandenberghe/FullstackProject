@model BookingSite.ViewModels.CartViewModel

@{
    ViewData["Title"] = "Shopping Cart";
    ViewData["TitleIcon"] = "cart";
    var checkoutAction = Model.Carts != null && Model.Carts.Any() ?
        $"<a href='{Url.Action("Checkout", "Cart")}' class='btn btn-outline-success'><i class='bi bi-credit-card me-2'></i>Proceed to Checkout</a>" : "";
    ViewData["PrimaryAction"] = checkoutAction;
}

@if (Model.Carts != null && Model.Carts.Any())
{
    <div class="card shadow-sm">
        <div class="card-body">
            <div class="table-responsive">
                <table class="table" id="myTable">
                    <thead>
                        <tr>
                            <th>From</th>
                            <th>To</th>
                            <th>Date</th>
                            <th>Price</th>
                            <th>Class</th>
                            <th>Meal</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach(var item in Model.Carts.Select((value, i) => new { v = value, Index = i }))
                        {
                            <tr>
                                <td>@Html.DisplayFor(modelItem => item.v.FromAirport)</td>
                                <td>@Html.DisplayFor(modelItem => item.v.ToAirport)</td>
                                <td>@Html.DisplayFor(modelItem => item.v.Date)</td>
                                <td>€ @Html.DisplayFor(modelItem => item.v.Price)</td>
                                <td>@Html.DisplayFor(modelItem => item.v.SeatClassName)</td>
                                <td>@Html.DisplayFor(modelItem => item.v.MealDescription)</td>
                                <td>
                                    <a asp-controller="Cart" asp-action="Remove"
                                       asp-route-index="@item.Index"
                                       class="btn btn-sm btn-danger">
                                        <i class="bi bi-trash"></i>
                                    </a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>

            <div class="mt-4 text-end">
                <h5>Total: €@Model.ComputeTotalValue()</h5>
            </div>
        </div>
    </div>
}
else
{
    <div class="text-center py-5">
        <div class="mb-4">
            <i class="bi bi-cart-x text-muted" style="font-size: 5rem;"></i>
        </div>
        <h3 class="text-muted">Your shopping cart is empty</h3>
        <p class="lead">Find your perfect flight and start booking your next adventure!</p>
        <a asp-controller="FlightsOverview" asp-action="Index" class="btn btn-primary btn-lg mt-3">
            <i class="bi bi-search"></i> Browse Available Flights
        </a>
    </div>
}